<!DOCTYPE html>
<html lang="id" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fiberhome Decoder Ultimate</title>
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        /* --- CSS VARIABLES & THEME ENGINE --- */
        :root {
            --bg-body: #f4f6f8;
            --bg-card: #ffffff;
            --text-main: #2c3e50;
            --text-muted: #637381;
            --primary: #3273dc;
            --primary-hover: #2366d1;
            --input-bg: #ffffff;
            --input-border: #dfe6e9;
            --shadow: 0 4px 20px rgba(0,0,0,0.08);
            --result-bg: #f9fafb;
            --transition-speed: 0.3s;
            --info-box-bg: #eefffa; /* Warna box admin info light */
            --info-box-text: #0e3f43;
        }

        [data-theme="dark"] {
            --bg-body: #121212;
            --bg-card: #1e1e1e;
            --text-main: #e0e0e0;
            --text-muted: #a0a0a0;
            --primary: #bb86fc;
            --primary-hover: #9e67e3;
            --input-bg: #2d2d2d;
            --input-border: #444;
            --shadow: 0 4px 20px rgba(0,0,0,0.5);
            --result-bg: #252525;
            --info-box-bg: #132e35; /* Warna box admin info dark */
            --info-box-text: #a4f4f9;
        }

        /* --- GLOBAL STYLE --- */
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-body);
            color: var(--text-main);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            transition: all var(--transition-speed);
        }

        .main-container { flex: 1; display: flex; align-items: center; justify-content: center; padding: 1.5rem; flex-direction: column; }
        
        .custom-card { 
            background-color: var(--bg-card); 
            border-radius: 16px; 
            box-shadow: var(--shadow); 
            border: none; 
            max-width: 480px; 
            width: 100%; 
            transition: all var(--transition-speed); 
        }
        
        .card-content { padding: 2.5rem; }
        
        .title { color: var(--text-main) !important; }
        .subtitle { color: var(--text-muted) !important; }

        /* Input Styling */
        .input { 
            background-color: var(--input-bg); 
            border-color: var(--input-border); 
            color: var(--text-main); 
            height: 3em; 
            border-radius: 8px; 
            font-family: monospace; /* Biar enak liat kode SSID */
        }
        .input:focus { border-color: var(--primary); box-shadow: 0 0 0 2px rgba(50, 115, 220, 0.2); }
        .input::placeholder { color: var(--text-muted); opacity: 0.7; font-family: 'Inter', sans-serif; }

        /* Button Styling */
        .button.is-primary { background-color: var(--primary); border-radius: 8px; height: 3em; font-weight: 600; transition: transform 0.1s; border: none; }
        .button.is-primary:hover { background-color: var(--primary-hover); }
        .button.is-primary:active { transform: scale(0.98); }

        /* Result Box */
        .result-box { 
            background-color: var(--result-bg); 
            border: 1px dashed var(--input-border); 
            border-radius: 8px; 
            padding: 1.5rem; 
            margin-top: 2rem; 
            text-align: center; 
            cursor: pointer; 
            transition: all var(--transition-speed); 
            position: relative;
        }
        .result-box:hover { border-color: var(--primary); }
        .result-text { font-size: 1.5rem; font-weight: 700; color: var(--primary); word-break: break-all; }
        .result-placeholder { color: var(--text-muted); font-size: 0.9rem; }

        /* Info Admin Box */
        .info-admin {
            background-color: var(--info-box-bg);
            color: var(--info-box-text);
            border-radius: 12px;
            padding: 1rem;
            margin-top: 1.5rem;
            display: none; /* Sembunyi default */
            border-left: 4px solid var(--primary);
            font-size: 0.9rem;
        }

        /* QR Code */
        #qrcode-container {
            display: none;
            margin-top: 1.5rem;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 1rem;
            background: white; /* QR Code harus background putih */
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            max-width: 200px;
            margin-left: auto;
            margin-right: auto;
        }

        /* History */
        .history-section { margin-top: 2rem; width: 100%; max-width: 480px; }
        .history-card { background-color: var(--bg-card); border-radius: 12px; padding: 1rem; box-shadow: var(--shadow); }
        .history-item { display: flex; justify-content: space-between; align-items: center; padding: 10px; border-bottom: 1px solid var(--input-border); font-size: 0.9rem; }
        .history-item:last-child { border-bottom: none; }
        .history-ssid { font-weight: 600; color: var(--text-main); }
        .history-pass { font-family: monospace; color: var(--primary); background: var(--result-bg); padding: 2px 6px; border-radius: 4px; cursor: pointer; }

        /* Trakteer & Misc */
        .trakteer-btn { background-color: #be1e2d !important; color: white !important; margin-top: 1rem; border-radius: 50px; border: none; box-shadow: 0 4px 6px rgba(190, 30, 45, 0.2); }
        .trakteer-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 12px rgba(190, 30, 45, 0.3); }
        
        .theme-switch-wrapper { position: absolute; top: 20px; right: 20px; }
        .theme-icon { color: var(--text-main); font-size: 1.5rem; cursor: pointer; padding: 8px; border-radius: 50%; background: var(--bg-card); box-shadow: var(--shadow); }

        /* Toast Notification */
        #toast { visibility: hidden; min-width: 250px; margin-left: -125px; background-color: var(--text-main); color: var(--bg-card); text-align: center; border-radius: 50px; padding: 12px 24px; position: fixed; z-index: 100; left: 50%; bottom: 30px; font-weight: 600; box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
        #toast.show { visibility: visible; animation: fadein 0.5s, fadeout 0.5s 2.5s; }
        @keyframes fadein { from {bottom: 0; opacity: 0;} to {bottom: 30px; opacity: 1;} }
        @keyframes fadeout { from {bottom: 30px; opacity: 1;} to {bottom: 0; opacity: 0;} }

    </style>
</head>
<body>

    <div class="theme-switch-wrapper">
        <span class="material-icons theme-icon" onclick="toggleTheme()" id="themeIcon">dark_mode</span>
    </div>

    <div class="main-container">
        <div class="card custom-card">
            <div class="card-content">
                
                <div class="has-text-centered mb-5">
                    <h1 class="title is-4">Fiberhome Decoder</h1>
                    <p class="subtitle is-6">
                        Ini adalah tools untuk mengetahui kata sandi default wifi fiberhome contoh <span class="has-text-weight-bold has-text-primary">"fh_94e640_5G"</span>
                    </p>
                </div>

                <div class="field">
                    <label class="label has-text-grey is-size-7">MASUKKAN SSID</label>
                    <div class="control has-icons-left">
                        <input class="input" type="text" id="kodeInput" placeholder="Contoh: fh_94e640_5G" onkeyup="if(event.keyCode === 13) konversi();" autocomplete="off">
                        <span class="icon is-small is-left"><i class="material-icons">wifi</i></span>
                    </div>
                </div>

                <div class="field mt-5">
                    <button class="button is-primary is-fullwidth" onclick="konversi()">
                        <span class="icon is-small mr-1"><i class="material-icons">auto_fix_high</i></span>
                        <span>Proses & Buat QR</span>
                    </button>
                </div>

                <div class="result-box" id="hasil-container" onclick="salinHasil()" title="Klik untuk menyalin">
                    <p class="is-size-7 has-text-grey-light mb-2">HASIL PASSWORD</p>
                    <div id="hasil" class="result-text"></div>
                    <div id="hasil-placeholder" class="result-placeholder">Password akan muncul di sini...</div>
                </div>

                <div id="admin-info" class="info-admin">
                    <div class="is-flex is-justify-content-space-between is-align-items-center mb-2">
                        <span class="has-text-weight-bold">‚ÑπÔ∏è Info Login Router (Default)</span>
                        <a href="http://192.168.1.1" target="_blank" class="tag is-link is-light">Buka Panel ‚Üó</a>
                    </div>
                    <div class="columns is-mobile is-gapless mb-0">
                        <div class="column">IP: <b>192.168.1.1</b></div>
                    </div>
                    <div class="columns is-mobile is-gapless">
                        <div class="column">User: <b>user</b></div>
                        <div class="column">Pass: <b>user1234</b></div>
                    </div>
                </div>

                <div id="qrcode-container">
                    <p class="is-size-7 has-text-grey has-text-centered mb-2">Scan untuk Connect</p>
                    <div id="qrcode"></div>
                </div>

                <div class="has-text-centered mt-6 pt-4" style="border-top: 1px solid var(--input-border);">
                    <p class="is-size-7 has-text-grey mb-3">Support developer untuk beli kopi ‚òï</p>
                    
                    <a href="https://trakteer.id/USERNAME_KAMU" target="_blank" class="button trakteer-btn is-fullwidth">
                        <span class="icon is-small mr-1"><i class="material-icons">favorite</i></span>
                        <span>Traktir Cendol</span>
                    </a>
                </div>

            </div>
        </div>

        <div class="history-section" id="historySection" style="display:none;">
            <div class="is-flex is-justify-content-space-between is-align-items-center mb-2 px-1">
                <span class="is-size-7 has-text-grey">Riwayat Pencarian</span>
                <span class="is-size-7 has-text-danger is-clickable" style="cursor:pointer;" onclick="clearHistory()">Hapus</span>
            </div>
            <div class="history-card" id="historyList">
                </div>
        </div>
    </div>

    <div id="toast">Password berhasil disalin! üëå</div>

<script>
    // --- LOGIC UTAMA ---
    const PETA_DARI_KODE = {
        'a': '5', 'b': '4', 'c': '3', 'd': '2', 'e': '1', 'f': '0',
        '6': '9', '7': '8', '8': '7', '9': '6'
    };

    function konversi() {
        const inputElem = document.getElementById('kodeInput');
        const inputText = inputElem.value.trim();
        
        if (!inputText) {
            showToastMessage("‚ö†Ô∏è Masukkan SSID dulu ya!");
            return;
        }

        // 1. Logic Dekripsi
        let kodeLower = inputText.toLowerCase();
        let kodeInti = kodeLower.replace('fh_', '');
        
        // Buang suffix (misal _5G)
        const underscoreIndex = kodeInti.indexOf('_');
        if (underscoreIndex !== -1) {
            kodeInti = kodeInti.substring(0, underscoreIndex);
        }

        // Mapping karakter
        let kodeDikonversi = '';
        for (let i = 0; i < kodeInti.length; i++) {
            let char = kodeInti[i];
            kodeDikonversi += PETA_DARI_KODE[char] || char; 
        }
        
        let hasilPassword = 'wlan' + kodeDikonversi;
        
        // 2. Tampilkan Hasil Text
        document.getElementById('hasil-placeholder').style.display = 'none';
        document.getElementById('hasil').textContent = hasilPassword;

        // 3. Tampilkan Info Admin
        document.getElementById('admin-info').style.display = 'block';

        // 4. Generate QR Code
        generateQR(inputText, hasilPassword);

        // 5. Simpan ke History
        addToHistory(inputText, hasilPassword);

        // 6. Efek Confetti (Hura-hura) üéâ
        confetti({
            particleCount: 150,
            spread: 70,
            origin: { y: 0.6 },
            colors: ['#3273dc', '#00d1b2', '#ffdd57', '#ff3860']
        });
    }

    function generateQR(ssid, password) {
        const qrContainer = document.getElementById('qrcode');
        const qrWrapper = document.getElementById('qrcode-container');
        
        qrContainer.innerHTML = ''; // Reset QR lama
        qrWrapper.style.display = 'flex'; // Munculkan box

        // String koneksi WiFi Android/iOS
        const wifiString = `WIFI:S:${ssid};T:WPA;P:${password};;`;

        new QRCode(qrContainer, {
            text: wifiString,
            width: 150,
            height: 150,
            colorDark : "#000000",
            colorLight : "#ffffff",
            correctLevel : QRCode.CorrectLevel.H
        });
    }

    // --- HISTORY SYSTEM ---
    function addToHistory(ssid, password) {
        let history = JSON.parse(localStorage.getItem('wifiHistory')) || [];
        
        // Cek duplikat (hapus yang lama biar yang baru naik ke atas)
        history = history.filter(item => item.ssid !== ssid);
        
        // Tambah ke paling atas
        history.unshift({ ssid, password });
        
        // Limit max 5 items
        if (history.length > 5) history.pop();
        
        localStorage.setItem('wifiHistory', JSON.stringify(history));
        renderHistory();
    }

    function renderHistory() {
        let history = JSON.parse(localStorage.getItem('wifiHistory')) || [];
        const historyList = document.getElementById('historyList');
        const historySection = document.getElementById('historySection');

        if (history.length === 0) {
            historySection.style.display = 'none';
            return;
        }

        historySection.style.display = 'block';
        historyList.innerHTML = '';

        history.forEach(item => {
            historyList.innerHTML += `
                <div class="history-item">
                    <span class="history-ssid">${item.ssid}</span>
                    <span class="history-pass" onclick="copyText('${item.password}')" title="Klik Copy">${item.password}</span>
                </div>
            `;
        });
    }
    
    function clearHistory() {
        localStorage.removeItem('wifiHistory');
        renderHistory();
        showToastMessage("Riwayat dihapus üóëÔ∏è");
    }

    // --- UTILITIES ---
    function salinHasil() {
        const hasilTeks = document.getElementById('hasil').textContent;
        if (hasilTeks) copyText(hasilTeks);
    }

    function copyText(text) {
        navigator.clipboard.writeText(text).then(() => {
            showToastMessage("Password berhasil disalin! üëå");
        });
    }

    function showToastMessage(msg) {
        const toast = document.getElementById("toast");
        toast.textContent = msg;
        toast.className = "show";
        setTimeout(() => { toast.className = toast.className.replace("show", ""); }, 3000);
    }

    // --- DARK MODE ENGINE ---
    const themeIcon = document.getElementById('themeIcon');
    const htmlEl = document.documentElement;
    
    // Cek preferensi user saat load
    const currentTheme = localStorage.getItem('theme');
    if (currentTheme) { 
        htmlEl.setAttribute('data-theme', currentTheme); 
        updateIcon(currentTheme); 
    }

    function toggleTheme() {
        let theme = htmlEl.getAttribute('data-theme');
        let newTheme = theme === 'dark' ? 'light' : 'dark';
        htmlEl.setAttribute('data-theme', newTheme);
        localStorage.setItem('theme', newTheme);
        updateIcon(newTheme);
    }

    function updateIcon(theme) {
        themeIcon.textContent = theme === 'dark' ? 'light_mode' : 'dark_mode';
    }

    // Load history saat pertama buka
    renderHistory();
</script>

</body>
</html>